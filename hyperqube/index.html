<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <title>Steven Thuriot.be &mdash; Thoughts, stories and ideas.</title> <meta name="description" content="Blogging about things on your new Jekyll site"/> <link rel="canonical" href="https://steven.thuriot.be/hyperqube"> <meta name="HandheldFriendly" content="True"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <meta name="theme-color" content="#434a4d"> <link rel="icon" sizes="192x192" href="//cdn.thuriot.be/images/Avatars/Raven.jpg"> <link rel="stylesheet" type="text/css" href="https://steven.thuriot.be/assets/css/main.css"/> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"> <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic%7CMontserrat:400,700"> </head> <body class="post-template"> <header id="orbs-bar" class="sidebar no-cover"> <nav id="site-head"> <div id="site-head-logo"> <a id="blog-logo" href="https://steven.thuriot.be"><img src="//cdn.thuriot.be/images/Avatars/Raven.jpg" alt="Steven Thuriot.be" title="Home"></a> </div> <div class="blog-links"> <a class="fa fa-terminal" role="presentation" href="https://steven.thuriot.be/projects" title="Projects"></a> <a class="fa fa-github-alt" role="presentation" href="https://steven.thuriot.be/GitHub" title="GitHub"></a> <a class="fa fa-street-view" role="presentation" href="https://steven.thuriot.be/cv" title="Curriculum Vitae"></a> <a class="fa fa-rss" role="presentation" href="https://steven.thuriot.be/rss" target="_blank" title="Subscribe"></a> </div> </nav> </header> <main class="content" role="main"> <article class="post"> <header class="post-header"> <h1 class="post-title">HyperQube</h1> <section class="post-meta"> <time class="post-date" datetime="2014-09-23">23 September 2014</time> on <a href="https://steven.thuriot.be/tag/projects/">Projects</a> </section> </header> <section class="post-content"> <p><a href="https://github.com/StevenThuriot/HyperQube">HyperQube</a> is(/started as) an IFTTT variant, built on top of PushBullet, created for the desktop.</p> <p>It connects to PushBullet&#39;s websocket using the API key provided in your account settings. It filters out the messages the plugins are interested in using <a href="https://github.com/Reactive-Extensions">Reactive Extensions</a>.</p> <p>Deep down, everything is built completely modular so each part is easy to replace by another component (loaded by MEF). (e.g. input can easily be replaced by another UI, in WPF, WinForms, ...) By default, everything is built with an eye on maximum compatibility. ( .NET / Mono )</p> <h1>Building plugins</h1> <p>A sample project has been set up <a href="https://github.com/steventhuriot/hyperqube-plugins">here</a>.</p> <p>First, create a new project. All you need to start is a reference to <code>HyperQube.Library</code>. To make life easy, a nuget package is available!</p> <div class="highlight"><pre><code class="language-xml" data-lang="xml">Install-Package HyperQube.Library
</code></pre></div> <p>Building a plugin is as simple as implementing an interface. </p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IQube</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">Title</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="c1">//Textual reference used throughout the project.</span>

  <span class="n">Interests</span> <span class="n">Interests</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="c1">//Things you are interested in. This is a flags enum.</span>

  <span class="k">void</span> <span class="nf">Receive</span><span class="p">(</span><span class="kt">dynamic</span> <span class="n">json</span><span class="p">);</span> <span class="c1">//Triggers each time a push message is received.</span>
<span class="p">}</span>
</code></pre></div> <p>Create a new class for your plugin and simply implement the interface.</p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">class</span> <span class="nc">Qube</span> <span class="p">:</span> <span class="n">IQube</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="kt">string</span> <span class="n">Title</span>
  <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="s">&quot;My First Plugin&quot;</span> <span class="p">};</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="n">Interests</span> <span class="n">Interests</span> 
  <span class="p">{</span>
    <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Interests</span><span class="p">.</span><span class="n">Note</span> <span class="p">|</span> <span class="n">Interests</span><span class="p">.</span><span class="n">Mirror</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">void</span> <span class="nf">Receive</span><span class="p">(</span><span class="kt">dynamic</span> <span class="n">json</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">//json contains the full push message in json format, as pushed by PushBullet. </span>
    <span class="c1">//http://docs.pushbullet.com/v2/pushes/</span>

    <span class="c1">//This can be used just like you would do in javascript, using dynamics.</span>

    <span class="c1">//To get the actual message, a helper is available.</span>
    <span class="c1">//This, in return, is a json object.</span>
    <span class="kt">var</span> <span class="n">jsonMessage</span> <span class="p">=</span> <span class="n">Push</span><span class="p">.</span><span class="n">GetBody</span><span class="p">((</span><span class="kt">object</span><span class="p">)</span><span class="n">json</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">jsonMessage</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">message</span> <span class="p">=</span> <span class="n">jsonMessage</span><span class="p">.</span><span class="n">ToString</span><span class="p">();</span>
      <span class="c1">//Do something with your newly acquired message!</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>This will do for basic cases, but in most cases you&#39;ll need to get some I/O going. Since HyperQube uses <code>MEF</code> to build up its infrastructure, you can simply define a constructor with the parameters you need.</p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="na">[ImportingConstructor]</span>
<span class="k">public</span> <span class="nf">Qube</span><span class="p">(</span><span class="n">IInputProvider</span> <span class="n">inputProvider</span><span class="p">,</span> <span class="n">IOutputProvider</span> <span class="n">outputProvider</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div> <p>The output provider can trace messages (e.g. logging) or visually show messages. In it&#39;s default state, using the <code>Write</code> method of the output provider will show a tooltip coming from the system tray.</p> <p>The input provider can be used to ask the user about some variables in your plugin. In the sample project, this is used to ask the user about their XBMC set up and what exactly they want the plugin to do.</p> <p>The user can be asked about these things by using Questions. A question is a class implementing <code>IQuestion</code>. A few default <a href="https://github.com/StevenThuriot/HyperQube/tree/master/HyperQube.Library/Questions">scenario&#39;s</a> have been implemented already.</p> <ul> <li>CheckBox / Toggle (<a href="https://github.com/StevenThuriot/HyperQube/blob/master/HyperQube.Library/Questions/BooleanQuestion.cs">BooleanQuestion</a>)</li> <li>ComboBox (<a href="https://github.com/StevenThuriot/HyperQube/blob/master/HyperQube.Library/Questions/SelectableQuestion.cs">SelectableQuestion</a>)</li> <li>TextBox / PasswordBox (<a href="https://github.com/StevenThuriot/HyperQube/blob/master/HyperQube.Library/Questions/TextQuestion.cs">TextQuestion</a>)</li> </ul> <p>A question can have two types of validation.</p> <ul> <li>Required field (semi-automatic by setting a simple boolean)</li> <li>Aditional validation by implementing <code>IValidatableQuestion</code> <ul> <li>This interface has a property that supplies a list of <code>IValidation</code> instances.</li> <li>A base class has been supplied to easily implement a validation: <code>Validation</code></li> <li>A validation contains a predicate that returns true if the value in the box is valid.</li> <li>It also contains a message to show when the value is not valid. <ul> <li>Two parameters can be used in these messages that will be replaced at runtime:</li> <li>{title} : The title of the plugin</li> <li>{value} : The value of the box.</li> </ul></li> <li>The sample project contains a few extra implementations that it needs, e.g. <a href="https://github.com/StevenThuriot/HyperQube-Plugins/blob/master/Qube.XBMC/Questions/UriQuestion.cs">a question that asks about a uri</a>.</li> <li>The <code>ValidationMessages</code> class contains a few default messages.</li> </ul></li> </ul> <p>In most cases, you&#39;ll want to trigger the input through the tray icon. You can add menu&#39;s to the tray icon for your plugin by implementing <code>IQubeMenuItem</code>.</p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IQubeMenuItem</span>
<span class="p">{</span>
  <span class="kt">string</span> <span class="n">MenuTitle</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span> <span class="c1">//The title shown in the tray.</span>
  <span class="k">void</span> <span class="nf">OpenMenu</span><span class="p">();</span> <span class="c1">//The method that gets called when the menu item is clicked.</span>
<span class="p">}</span>
</code></pre></div> <p>If you only have one menu item, the title will actually be the name of your plugin. The <code>MenuTitle</code> is a fallback when your plugin has submenu&#39;s. You can give your plugin submenus by implementing <code>IQubeMenuItemWithSubMenus</code>, which inherits from <code>IQubeMenuItem</code>.</p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">interface</span> <span class="n">IQubeMenuItemWithSubMenus</span> <span class="p">:</span> <span class="n">IQubeMenuItem</span>
<span class="p">{</span>
  <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">IQubeMenuItem</span><span class="p">&gt;</span> <span class="n">SubMenuItems</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>This way, you can have as many menu&#39;s and submenu&#39;s that you need.</p> <p>After doing all this, simply build your plugin and drop it anywhere in the root or any subfolder of the <code>HyperQube</code> executable. <code>MEF</code> will automatically pick up your new plugin!</p> </section> <footer class="post-footer with-cover" style="background-image: url(//cdn.thuriot.be/images/Covers/db0b47_5415753.jpg)"> <figure class="author-image"> <a class="img" href="https://steven.thuriot.be/author/steven" style="background-image: url(//cdn.thuriot.be/images/Avatars/2014-07-06.jpg)"> <span class="hidden">Steven Thuriot's Picture</span></a> </figure> <section class="author"> <h4><a href="https://steven.thuriot.be/author/steven">Steven Thuriot</a></h4> <p>Developer, tinkerer, lifetime student, full time nerd and somewhat of an otaku. Graduated applied computer science followed by a career as a consultant. Likes to complain about traffic.</p> <div class="author-meta"> <span class="author-location fa fa-map-marker">Belgium</span> </div> </section> </footer> </article> <section class="disqus"> <div id="disqus_thread"></div> <script type="text/javascript">(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//thuriot.disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a);})();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript> </section> </main> <footer class="site-footer clearfix wide"> <section class="copyright"><a href="https://steven.thuriot.be">Steven Thuriot.be</a> &copy; 2015</section> </footer> <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script> <script type="text/javascript" src="https://steven.thuriot.be/assets/js/jquery.fitvids.js"></script> </body> </html>