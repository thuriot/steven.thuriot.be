<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <title>Steven Thuriot.be &mdash; Thoughts, stories and ideas.</title> <meta name="description" content="Blogging about things on your new Jekyll site"/> <link rel="canonical" href="http://steven.thuriot.be/modal-message-box-for-winforms-in-net-2-0"> <meta name="HandheldFriendly" content="True"/> <meta name="viewport" content="width=device-width, initial-scale=1.0"/> <meta name="theme-color" content="#434a4d"> <link rel="icon" sizes="192x192" href="//cdn.thuriot.be/Avatars/Raven.jpg"> <link rel="stylesheet" type="text/css" href="//steven.thuriot.be/assets/css/main.css"/> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"> <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic%7CMontserrat:400,700"> </head> <body class="post-template"> <header id="orbs-bar" class="sidebar no-cover"> <nav id="site-head"> <div id="site-head-logo"> <a id="blog-logo" href="//steven.thuriot.be"><img src="//cdn.thuriot.be/Avatars/Raven.jpg" alt="Steven Thuriot.be" title="Home"></a> </div> <div class="blog-links"> <a class="fa fa-terminal" role="presentation" href="//steven.thuriot.be/projects" title="Projects"></a> <a class="fa fa-github-alt" role="presentation" href="//steven.thuriot.be/GitHub" title="GitHub"></a> <a class="fa fa-street-view" role="presentation" href="//steven.thuriot.be/cv" title="Curriculum Vitae"></a> <a class="fa fa-rss" role="presentation" href="//steven.thuriot.be/rss" target="_blank" title="Subscribe"></a> </div> </nav> </header> <main class="content" role="main"> <article class="post"> <header class="post-header"> <h1 class="post-title">Modal Message Box for WinForms in .NET 2.0+</h1> <section class="post-meta"> <time class="post-date" datetime="2012-01-12">12 January 2012</time> on <a href="//steven.thuriot.be/tag/net/">.Net</a>, <a href="//steven.thuriot.be/tag/c/">C#</a>, <a href="//steven.thuriot.be/tag/helper/">Helper</a>, <a href="//steven.thuriot.be/tag/lightbox/">Lightbox</a> </section> </header> <section class="post-content"> <p>The other day at work I felt the need to show the user a message, but wanted to do it a bit more fancy than just use the regular, old, boring MessageBox. </p> <p>I personally really enjoy the &quot;LightBox effect&quot; where the background darkens and the LightBox popped up. Because of the way WinForms work, this wasn&#39;t as simple as I was hoping it would be. I worked out a little solution and decided to share.</p> <div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">ModalMessageBox</span> <span class="p">:</span> <span class="n">Form</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nf">ModalMessageBox</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">Font</span> <span class="n">font</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">parent</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;parent&quot;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">font</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentNullException</span><span class="p">(</span><span class="s">&quot;font&quot;</span><span class="p">);</span>

        <span class="n">InitializeComponent</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">font</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeOKButton</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">okButton</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Button</span>
                            <span class="p">{</span>
                                <span class="n">Anchor</span> <span class="p">=</span> <span class="p">(((</span><span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Bottom</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Right</span><span class="p">))),</span>
                                <span class="n">Size</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="m">99</span><span class="p">,</span> <span class="m">23</span><span class="p">),</span>
                                <span class="n">TabIndex</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                                <span class="n">Text</span> <span class="p">=</span> <span class="s">&quot;OK&quot;</span><span class="p">,</span>
                                <span class="n">UseVisualStyleBackColor</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
                                <span class="n">DialogResult</span> <span class="p">=</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">,</span>
                            <span class="p">};</span>

        <span class="n">okButton</span><span class="p">.</span><span class="n">Location</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">okButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="m">11</span><span class="p">,</span>
                                        <span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">okButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">11</span><span class="p">);</span>


        <span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">okButton</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeYesNoButtons</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">noButton</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Button</span>
                            <span class="p">{</span>
                                <span class="n">Anchor</span> <span class="p">=</span> <span class="p">(((</span><span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Bottom</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Right</span><span class="p">))),</span>
                                <span class="n">Size</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="m">99</span><span class="p">,</span> <span class="m">23</span><span class="p">),</span>
                                <span class="n">TabIndex</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                                <span class="n">Text</span> <span class="p">=</span> <span class="s">&quot;No&quot;</span><span class="p">,</span>
                                <span class="n">UseVisualStyleBackColor</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
                                <span class="n">DialogResult</span> <span class="p">=</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">No</span>
                            <span class="p">};</span>

        <span class="n">noButton</span><span class="p">.</span><span class="n">Location</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">noButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="m">11</span><span class="p">,</span>
                                        <span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">noButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">11</span><span class="p">);</span>

        <span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">noButton</span><span class="p">);</span>

        <span class="kt">var</span> <span class="n">yesButton</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Button</span>
                            <span class="p">{</span>
                                <span class="n">Anchor</span> <span class="p">=</span> <span class="p">(((</span><span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Bottom</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Right</span><span class="p">))),</span>
                                <span class="n">Size</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="m">99</span><span class="p">,</span> <span class="m">23</span><span class="p">),</span>
                                <span class="n">TabIndex</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                                <span class="n">Text</span> <span class="p">=</span> <span class="s">&quot;Yes&quot;</span><span class="p">,</span>
                                <span class="n">UseVisualStyleBackColor</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span>
                                <span class="n">DialogResult</span> <span class="p">=</span> <span class="n">DialogResult</span><span class="p">.</span><span class="n">Yes</span>
                            <span class="p">};</span>

        <span class="n">yesButton</span><span class="p">.</span><span class="n">Location</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">yesButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">noButton</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="m">16</span><span class="p">,</span>
                                        <span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="n">yesButton</span><span class="p">.</span><span class="n">Size</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">11</span><span class="p">);</span>

        <span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">yesButton</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">InitializeComponent</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">Font</span> <span class="n">font</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">SuspendLayout</span><span class="p">();</span>

        <span class="kt">var</span> <span class="n">questionLabel</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Label</span>
                                <span class="p">{</span>
                                    <span class="n">Anchor</span> <span class="p">=</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Top</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Bottom</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Left</span> <span class="p">|</span> <span class="n">AnchorStyles</span><span class="p">.</span><span class="n">Right</span><span class="p">,</span>
                                    <span class="n">BackColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">White</span><span class="p">,</span>
                                    <span class="n">BorderStyle</span> <span class="p">=</span> <span class="n">BorderStyle</span><span class="p">.</span><span class="n">FixedSingle</span><span class="p">,</span>
                                    <span class="n">Font</span> <span class="p">=</span> <span class="n">font</span><span class="p">,</span>
                                    <span class="n">ForeColor</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">Black</span><span class="p">,</span>
                                    <span class="n">ImeMode</span> <span class="p">=</span> <span class="n">ImeMode</span><span class="p">.</span><span class="n">NoControl</span><span class="p">,</span>
                                    <span class="n">Location</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span>
                                    <span class="n">TabIndex</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span>
                                    <span class="n">Text</span> <span class="p">=</span> <span class="n">message</span><span class="p">,</span>
                                    <span class="n">TextAlign</span> <span class="p">=</span> <span class="n">ContentAlignment</span><span class="p">.</span><span class="n">MiddleCenter</span>
                                <span class="p">};</span>

        <span class="kt">var</span> <span class="n">height</span> <span class="p">=</span> <span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">78</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">height</span> <span class="p">&gt;</span> <span class="m">300</span><span class="p">)</span>
            <span class="n">height</span> <span class="p">=</span> <span class="m">300</span><span class="p">;</span>

        <span class="n">questionLabel</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="m">20</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>

        <span class="n">MaximizeBox</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">MinimizeBox</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">ShowInTaskbar</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">SizeGripStyle</span> <span class="p">=</span> <span class="n">SizeGripStyle</span><span class="p">.</span><span class="n">Hide</span><span class="p">;</span>
        <span class="n">FormBorderStyle</span> <span class="p">=</span> <span class="n">FormBorderStyle</span><span class="p">.</span><span class="n">None</span><span class="p">;</span>

        <span class="n">StartPosition</span> <span class="p">=</span> <span class="n">FormStartPosition</span><span class="p">.</span><span class="n">Manual</span><span class="p">;</span>
        <span class="n">ClientSize</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Width</span> <span class="p">+</span> <span class="m">2</span><span class="p">,</span> <span class="n">parent</span><span class="p">.</span><span class="n">ClientSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">+</span> <span class="m">2</span><span class="p">);</span>

        <span class="n">Rectangle</span> <span class="n">screenRectangle</span> <span class="p">=</span> <span class="n">parent</span><span class="p">.</span><span class="n">RectangleToScreen</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">ClientRectangle</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">titleHeight</span> <span class="p">=</span> <span class="n">screenRectangle</span><span class="p">.</span><span class="n">Top</span> <span class="p">-</span> <span class="n">parent</span><span class="p">.</span><span class="n">Top</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">borderWidth</span> <span class="p">=</span> <span class="n">screenRectangle</span><span class="p">.</span><span class="n">Left</span> <span class="p">-</span> <span class="n">parent</span><span class="p">.</span><span class="n">Left</span><span class="p">;</span>

        <span class="n">Location</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">Location</span><span class="p">.</span><span class="n">X</span> <span class="p">+</span> <span class="n">borderWidth</span> <span class="p">-</span> <span class="m">1</span><span class="p">,</span> <span class="n">parent</span><span class="p">.</span><span class="n">Location</span><span class="p">.</span><span class="n">Y</span> <span class="p">+</span> <span class="n">titleHeight</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>

        <span class="n">TransparencyKey</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">LightSteelBlue</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">hatchBrush</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HatchBrush</span><span class="p">(</span><span class="n">HatchStyle</span><span class="p">.</span><span class="n">Percent50</span><span class="p">,</span> <span class="n">TransparencyKey</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">backgroundImage</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Bitmap</span><span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">50</span><span class="p">);</span>

        <span class="n">Graphics</span> <span class="n">imageGraphics</span> <span class="p">=</span> <span class="n">Graphics</span><span class="p">.</span><span class="n">FromImage</span><span class="p">(</span><span class="n">backgroundImage</span><span class="p">);</span>
        <span class="n">imageGraphics</span><span class="p">.</span><span class="n">FillRectangle</span><span class="p">(</span><span class="n">hatchBrush</span><span class="p">,</span> <span class="n">DisplayRectangle</span><span class="p">);</span>

        <span class="n">AllowTransparency</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="n">backgroundImage</span><span class="p">.</span><span class="n">MakeTransparent</span><span class="p">(</span><span class="n">TransparencyKey</span><span class="p">);</span>

        <span class="n">BackColor</span> <span class="p">=</span> <span class="n">TransparencyKey</span><span class="p">;</span>
        <span class="n">BackgroundImage</span> <span class="p">=</span> <span class="n">backgroundImage</span><span class="p">;</span>
        <span class="n">BackgroundImageLayout</span> <span class="p">=</span> <span class="n">ImageLayout</span><span class="p">.</span><span class="n">Tile</span><span class="p">;</span>

        <span class="n">Controls</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">questionLabel</span><span class="p">);</span>

        <span class="k">switch</span> <span class="p">(</span><span class="n">buttons</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">OK</span><span class="p">:</span>
                <span class="n">InitializeOKButton</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">YesNo</span><span class="p">:</span>
                <span class="n">InitializeYesNoButtons</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="p">:</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentOutOfRangeException</span><span class="p">(</span><span class="s">&quot;buttons&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">ResumeLayout</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">DialogResult</span> <span class="nf">Show</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Show</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">DialogResult</span> <span class="nf">Show</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span> <span class="n">buttons</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nf">Show</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">parent</span><span class="p">.</span><span class="n">Font</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">delegate</span> <span class="n">DialogResult</span> <span class="nf">ShowDelegate</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">Font</span> <span class="n">font</span><span class="p">);</span>

    <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">ShowDelegate</span> <span class="n">InternalShow</span> <span class="p">=</span> 
        <span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">font</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">ModalMessageBox</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">font</span><span class="p">).</span><span class="n">ShowDialog</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">DialogResult</span> <span class="nf">Show</span><span class="p">(</span><span class="n">Form</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">,</span> <span class="n">MessageBoxButtons</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">Font</span> <span class="n">font</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">parent</span><span class="p">.</span><span class="n">InvokeRequired</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">parent</span><span class="p">.</span><span class="n">Invoke</span><span class="p">(</span><span class="n">InternalShow</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">font</span><span class="p">);</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">DialogResult</span><span class="p">)</span> <span class="n">result</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nf">InternalShow</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">buttons</span><span class="p">,</span> <span class="n">font</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>The result looks like this:</p> <p>Before the pop-up <a href="//cdn.thuriot.be/ModalMessageBox/Input1.png"><img src="//cdn.thuriot.be/ModalMessageBox/Input1.png" alt="Input before the message pops up"></a></p> <p>After the pop-up <a href="//cdn.thuriot.be/ModalMessageBox/Input2.png"><img src="//cdn.thuriot.be/ModalMessageBox/Input2.png" alt="Input after the message pops up"></a></p> </section> <footer class="post-footer with-cover" style="background-image: url(//cdn.thuriot.be/Covers/db0b47_5415753.jpg)"> <figure class="author-image"> <a class="img" href="//steven.thuriot.be/author/steven" style="background-image: url(//cdn.thuriot.be/Avatars/2014-07-06.jpg)"> <span class="hidden">Steven Thuriot's Picture</span></a> </figure> <section class="author"> <h4><a href="//steven.thuriot.be/author/steven">Steven Thuriot</a></h4> <p>Developer, tinkerer, lifetime student, full time nerd and somewhat of an otaku. Graduated applied computer science followed by a career as a consultant. Likes to complain about traffic.</p> <div class="author-meta"> <span class="author-location fa fa-map-marker">Belgium</span> </div> </section> </footer> </article> <section class="disqus"> <div id="disqus_thread"></div> <script type="text/javascript">(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//thuriot.disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a);})();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript> </section> </main> <footer class="site-footer clearfix wide"> <section class="copyright"><a href="//steven.thuriot.be">Steven Thuriot.be</a> &copy; 2015</section> </footer> <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script> <script type="text/javascript" src="//steven.thuriot.be/assets/js/jquery.fitvids.js"></script> </body> </html>